% !TeX root = ../thesis.tex
\section{Cryptosystem}
\subsection{The Supersingular Isogeny Diffie-Hellman protocol}

The idea of the SIKE cryptosystem is to establish a Diffie-Hellman key-exchange protocol based on isogenies between supersingular elliptic curves. 



\begin{enumerate}[(1)]
	\item We start by generating the \textit{public parameters}: Choose $e_A,e_B$ and look for a prime $p=2^{e_A}3^{e_B}f\pm1$. Set $q=p^2$ and find a supersingular curve $E$ over $\mathbb{F}_q$. Finally, select points $P_A,Q_A$ s.t. they generate the endomorphism $E[2^{e_A}]$ and $P_B,Q_B$ s.t. $\langle P_B,Q_B\rangle=E[3^{e_B}]$. %TODO: What prevents the points from having an order other than 3^{e_B} 2^{e_A}?
	\item Subsequently Alice and Bob choose \textit{secret parameters} $m_A,n_A$ and $m_B,n_B$ respectively to find the secret points $[m_A]P_A + [n_A]Q_A$ and $[m_B]P_B + [n_B]Q_B$. The groups generated by these points serve as the kernels for the secret isogenies $\phi_A : E \to E/A$ and $\phi_B : E \to E/B$. 
	\item In order to allow Bob compute a secret point in E/A, Alice sends him $\phi_A(P_B)$ and $\phi_A(Q_B)$. Upon receival Bob then finds $T_B = \phi_A([m_B]P_B + [n_B]Q_B)$ in $E/A$ and uses $\langle T_B \rangle$ as kernel for $\phi^{\prime}_B : E/A \to E/BA$. Alice proceeds \textit{mutatis mutandis} with $T_A = \phi_B([m_A]P_A + [n_A]Q_A)$ and computes $\phi^{\prime}_A : E/B \to E/AB$ with $ker(\phi^{\prime}_A)= \langle T_A \rangle$.
	\item As shown in \ref{ch:correctness}, $E/AB \cong E/BA$ and therefore the shared secret key can be generated from $j(E/AB)=j(E/BA)$.
\end{enumerate} 
	The public parameters in this protocol are $e_A,e_B$, $p$, $E$, $E/A$, $E/B$,$P_A,Q_A,P_B,Q_B, \phi_A(P_B)$, $\phi_A(Q_B)$, $\phi_B(P_A)$ and $\phi_B(Q_A)$. Secret parameters entail $m_A,n_A$, $m_B,n_B$, $\phi_A$ and $\phi_B$. 
	
		%TODO: Schaubild anh√§ngen

	It is easy to see that the protocol could be broken, if an attacker would be able to:
	
	\begin{itemize}[\textbullet]
		\item Compute $\phi_A$ given $E$ and $E/A$ ("Decisional Supersingular Isogeny problem")
		\item Find a generator  of $\langle[m_A]P_A + [n_A]Q_A\rangle$ given $E/A$ and $\phi_A(P_B)$, $\phi_A(Q_B)$ ("Computational Supersingular Isogeny problem")
		\item Find the j-invariant of E/AB given E/A, E/B and $\phi_A(P_B)$, $\phi_A(Q_B),\phi_B(P_A)$, $\phi_B(Q_A)$ ("Supersingular Decision Diffie-Hellman problem")
	\end{itemize}

So far, there are no known subexponential algorithms for any of these problems.


\subsection{Correctness}
\label{ch:correctness}

$E/AB$ is isomorphic to $E/BA$ iff $ker(\phi_B^{\prime})=ker(\phi_A^{\prime})$. %TODO citation
In the following we will prove that $\phi_B^{\prime}$ and $\phi_A^{\prime}$ have the same kernel indeed.\\

\textbf{Lemma 1:} Let $\phi_1: G_1 \to G_2$ and $\phi_2: G_2 \to G_3$ be group homomorphisms with $ker(\phi_1) = \langle K_1 \rangle$ and $ker(\phi_2) = \phi_1(\langle K_2 \rangle)$. Then for $\phi:G_1 \to G_3$ defined by $\phi=\phi_2 \circ \phi_1$ we have $ker(\phi) =\langle K_1,K_2\rangle$.\\%TODO: cite bennies paper

\textbf{Theorem 2:} $ker(\phi_B^{\prime} \circ \phi_A) = ker(\phi_A^{\prime} \circ \phi_B)$\\
\textbf{Proof:}
\begin{enumerate}[(i)]
	\item $ker(\phi_B^{\prime})=\phi_A(\langle [m_B]P_B + [n_B]Q_B)\rangle)$
	\item $ker(\phi_A)=\langle [m_A]P_A + [n_A]Q_A\rangle$
	\item $ker(\phi_B^{\prime} \circ \phi_A) \stackrel{\text{Lemma 1}}{=} \langle [m_A]P_A + [n_A]Q_A, [m_B]P_B + [n_B]Q_B \rangle$
	\item The application of Lemma 1 on $\phi_A^{\prime} \circ \phi_B$ yields the same kernel
\end{enumerate}



\subsection{Computational Details}
%TODO: Why is it easy to compute isogenies?

Given $E$ and a generator $R$ of $E[2^{e_A}]$, computing an isogeny $\phi:E \to E/A$ with $ker(\langle R \rangle)$  can be done in $\mathcal{O}(2^{e_A})$ using Velu's formula. %TODO: citation

Computing $\phi_G : E \to E/A$ from $E$ and $A$ takes time polynomial in $\#A$. Since $2^{e_A} \in \mathcal{O}(\sqrt{p})$, this is not acceptable.\\
	
	\textbf{Solution:} Compute isogeny of large degree as a composition of isogenies of small degree. Then $\phi = \phi_1 \circ \dots \circ \phi_k \circ [n]$ where $\phi_1 \circ \dots \circ \phi_k$ are isogenies of prime degree that are defined over $\mathbb{F}_q$ and $deg(\phi) = n^2 \prod^k_{i=1} deg(\phi_i)$.\\
	 While computing the composition of $t$ isogenies of degree $t$ takes time proportional to $t$, the cost of computing the composition in a single step is in $\mathcal{O}(2^t)$\\

